{
    "version": "0.5.3.0",
    "description": "A Terminal Emulator based on UWP and web technologies. - felixse/FluentTerminal",
    "homepage": "https://github.com/felixse/FluentTerminal",
    "license": "GPL-3.0",
    "url": "https://github.com/felixse/FluentTerminal/releases/download/0.5.3.0/FluentTerminal.App_0.5.3.0_Test.zip#/install.ms",
    "hash": "eefd738ac449b8c3e1f1a3f0b0c59b701c267d11ff5610e793b0c7e80a3b79d3",
    "pre_install": [
        "7z x -tzip \"$dir\\install.ms\" -o\"$dir\\tmp\""
    ],
    "installer": {
        "script":[
            "$osversionLookup = @{",
            "    \"5.1.2600\" = \"XP\";",
            "    \"5.1.3790\" = \"2003\";",
            "    \"6.0.6001\" = \"Vista/2008\";",
            "    \"6.1.7600\" = \"Win7/2008R2\";",
            "    \"6.1.7601\" = \"Win7 SP1/2008R2 SP1\"; # SP1 or later.",
            "    \"6.2.9200\" = \"Win8/2012\";",
            "    \"6.3.9600\" = \"Win8.1/2012R2\";",
            "    \"10.0.*\" = \"Windows 10/Server 2016\"",
            "    }",
            "$os = Get-WmiObject Win32_OperatingSystem",
            "$osVersion = $os.version",
            "$ProductName = (Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion' -Name 'ProductName').ProductName",
            "$EditionId = (Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion' -Name 'EditionID').EditionId",
            "",
            "#This will show us if we are running on Nano Server (Kernel version alone won't show this)",
            "Write-Output \"Running on: $ProductName, ($EditionId), Windows Kernel: $osVersion\"",
            "",
            "if( ([version]$osVersion).Major -eq \"10\" ) {",
            "     $osVersion = \"$(([version]$osVersion).Major).$(([version]$osVersion).Minor).*\"",
            "}",
            "    ",
            "switch ($osversionLookup[$osVersion]) {",
            "    \"Windows 10/Server 2016\" {",
            "        # Ok",
            "    }",
            "    default {",
            "        # Windows XP, Windows 2003, Windows Vista, Windows 7, or unknown?",
            "        throw \"$packageName is not supported on $ProductName, ($EditionId), Windows Kernel: $osVersion\"",
            "    }",
            "}",
            " ",
            "# Version check OK, go ahead and install",
            "echo \"Enabling App Sideloading\"",
            "reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock\" /t REG_DWORD /f /v \"AllowAllTrustedApps\" /d \"1\"",
            "& \"$dir\\tmp\\Install.ps1\" -Force -ForceContextMenu",
            "if ( -not $? ) { Exit 1 }",
            "Remove-Item \"$dir\\tmp\" -Recurse",
            "echo \"Installation complete\""
        ]
    },
    "uninstaller": {
        "script":[
            "Get-AppxPackage -Name *FluentTerminal* | Remove-AppxPackage -AllUsers",
            "& certutil -delstore TrustedPeople 1ec0504f23d8f58f4b2cbe942f41d279",
            "reg delete \"HKCU\\Software\\Classes\\Directory\\shell\\Open Fluent Terminal here\" /f",
            "reg delete \"HKCU\\Software\\Classes\\Directory\\Background\\shell\\Open Fluent Terminal here\" /f",
            "reg delete \"HKCU\\Software\\Classes\\Directory\\LibraryFolder\\shell\\Open Fluent Terminal here\" /f"
        ]
    },
    "checkver":"github",
    "autoupdate": {
        "url": "https://github.com/felixse/FluentTerminal/releases/download/$version/FluentTerminal.App_$version_Test.zip#/install.zip"
    }
}
